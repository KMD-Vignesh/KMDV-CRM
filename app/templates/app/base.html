{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>KMDV CRM</title>
    <link rel="stylesheet" type="text/css" href="{% static 'app/css/base.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app/css/messages.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app/css/table_cont.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app/css/forms.css' %}">


  </head>
  <body>
    <div class="container">
      <nav>
        {% if user.is_authenticated %}
        <a href="{% url 'dashboard' %}">Dashboard</a>
        <a href="{% url 'category_list' %}">Categories</a>
        <a href="{% url 'product_list' %}">Products</a>
        <a href="{% url 'vendor_list' %}">Vendors</a>
        <a href="{% url 'inventory_list' %}">Inventory</a>
        <a href="{% url 'order_list' %}">Orders</a>
        <a href="{% url 'profile' %}">Profile</a>
        <span class="user-welcome" style="color: #ecf0f1"
          >Welcome, {{ user.username | title }}!</span
        >
        {% else %}
        <span class="user-welcome" style="color: #ecf0f1">Welcome, Guest!</span>
        {% endif %} {% if user.is_authenticated %}
        <form method="post" action="{% url 'logout' %}" style="display: inline">
          {% csrf_token %}
          <button type="submit" class="nav-a">Logout</button>
        </form>
        {% else %}
        <a href="{% url 'login' %}">Login</a>
        <a href="{% url 'register' %}">Register</a>
        {% endif %}
      </nav>
      <div class="content">{% block content %}{% endblock %}</div>
    </div>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const links = document.querySelectorAll("nav a");
        links.forEach((link) => {
          link.addEventListener("click", (e) => {
            links.forEach((l) => (l.style.color = "#ecf0f1"));
            e.target.style.color = "#3498db";
          });
        });
      });

      document.addEventListener("DOMContentLoaded", function () {
        // Handle all messages with dismiss classes
        const messages = document.querySelectorAll(".alert");

        messages.forEach(function (message) {
          let duration = 3000; // default 30 seconds

          // Check for dismiss-X classes
          const classes = message.className.split(" ");
          classes.forEach(function (cls) {
            if (cls.startsWith("dismiss-")) {
              duration = parseInt(cls.replace("dismiss-", "")) * 1000;
            }
          });

          // Auto-hide after duration
          setTimeout(function () {
            if (message.parentElement) {
              message.style.transition = "opacity 0.5s ease-out";
              message.style.opacity = "0";
              setTimeout(function () {
                if (message.parentElement) {
                  message.remove();
                }
              }, 500);
            }
          }, duration);
        });
      });
    </script>
  </body>
</html>
